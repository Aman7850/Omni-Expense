{"version":3,"sources":["NativeStackView.tsx"],"names":["StackActions","useTheme","React","Platform","StyleSheet","View","AppContainer","Screen","ScreenComponent","ScreenStack","HeaderConfig","isAndroid","OS","didWarn","Container","__DEV__","DebugContainer","props","stackPresentation","rest","maybeRenderNestedStack","options","route","renderScene","isHeaderInModal","viewStyles","styles","container","absoluteFill","NativeStackView","state","navigation","descriptors","key","routes","colors","map","index","render","contentStyle","gestureEnabled","headerShown","replaceAnimation","screenOrientation","stackAnimation","statusBarAnimation","statusBarColor","statusBarHidden","statusBarStyle","statusBarTranslucent","backgroundColor","background","undefined","console","warn","isHeaderInPush","emit","type","data","closing","target","e","dismissCount","nativeEvent","dispatch","pop","source","create","flex"],"mappings":"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","sourcesContent":["import {\n  ParamListBase,\n  StackActions,\n  StackNavigationState,\n  useTheme,\n  Route,\n} from '@react-navigation/native';\nimport * as React from 'react';\nimport {\n  Platform,\n  StyleProp,\n  StyleSheet,\n  View,\n  ViewProps,\n  ViewStyle,\n} from 'react-native';\n// @ts-ignore Getting private component\nimport AppContainer from 'react-native/Libraries/ReactNative/AppContainer';\nimport {\n  Screen as ScreenComponent,\n  ScreenProps,\n  ScreenStack,\n  StackPresentationTypes,\n} from 'react-native-screens';\nimport {\n  NativeStackDescriptorMap,\n  NativeStackNavigationHelpers,\n  NativeStackNavigationOptions,\n} from '../types';\nimport HeaderConfig from './HeaderConfig';\n\nconst Screen = (ScreenComponent as unknown) as React.ComponentType<ScreenProps>;\nconst isAndroid = Platform.OS === 'android';\n\nlet didWarn = isAndroid;\n\nlet Container = View;\n\nif (__DEV__) {\n  const DebugContainer = (\n    props: ViewProps & { stackPresentation: StackPresentationTypes }\n  ) => {\n    const { stackPresentation, ...rest } = props;\n    if (Platform.OS === 'ios' && stackPresentation !== 'push') {\n      return (\n        <AppContainer>\n          <View {...rest} />\n        </AppContainer>\n      );\n    }\n    return <View {...rest} />;\n  };\n  // @ts-ignore Wrong props\n  Container = DebugContainer;\n}\n\nconst maybeRenderNestedStack = (\n  options: NativeStackNavigationOptions,\n  route: Route<string>,\n  renderScene: () => JSX.Element,\n  stackPresentation: StackPresentationTypes,\n  isHeaderInModal: boolean,\n  viewStyles: StyleProp<ViewStyle>\n): JSX.Element => {\n  if (isHeaderInModal) {\n    return (\n      <ScreenStack style={styles.container}>\n        <Screen enabled style={StyleSheet.absoluteFill}>\n          <HeaderConfig {...options} route={route} />\n          <Container\n            style={viewStyles}\n            // @ts-ignore Wrong props passed to View\n            stackPresentation={stackPresentation}>\n            {renderScene()}\n          </Container>\n        </Screen>\n      </ScreenStack>\n    );\n  }\n  return (\n    <Container\n      style={viewStyles}\n      // @ts-ignore Wrong props passed to View\n      stackPresentation={stackPresentation}>\n      {renderScene()}\n    </Container>\n  );\n};\n\ntype Props = {\n  state: StackNavigationState<ParamListBase>;\n  navigation: NativeStackNavigationHelpers;\n  descriptors: NativeStackDescriptorMap;\n};\n\nexport default function NativeStackView({\n  state,\n  navigation,\n  descriptors,\n}: Props): JSX.Element {\n  const { key, routes } = state;\n  const { colors } = useTheme();\n\n  return (\n    <ScreenStack style={styles.container}>\n      {routes.map((route, index) => {\n        const { options, render: renderScene } = descriptors[route.key];\n        const {\n          contentStyle,\n          gestureEnabled,\n          headerShown,\n          replaceAnimation = 'pop',\n          screenOrientation,\n          stackAnimation,\n          statusBarAnimation,\n          statusBarColor,\n          statusBarHidden,\n          statusBarStyle,\n          statusBarTranslucent,\n        } = options;\n\n        let { stackPresentation = 'push' } = options;\n\n        if (index === 0) {\n          // first screen should always be treated as `push`, it resolves problems with no header animation\n          // for navigator with first screen as `modal` and the next as `push`\n          stackPresentation = 'push';\n        }\n\n        const viewStyles = [\n          styles.container,\n          stackPresentation !== 'transparentModal' &&\n            stackPresentation !== 'containedTransparentModal' && {\n              backgroundColor: colors.background,\n            },\n          contentStyle,\n        ];\n\n        if (\n          !didWarn &&\n          stackPresentation !== 'push' &&\n          headerShown !== undefined\n        ) {\n          didWarn = true;\n          console.warn(\n            'Be aware that changing the visibility of header in modal on iOS will result in resetting the state of the screen.'\n          );\n        }\n\n        const isHeaderInModal = isAndroid\n          ? false\n          : stackPresentation !== 'push' && headerShown === true;\n        const isHeaderInPush = isAndroid\n          ? headerShown\n          : stackPresentation === 'push' && headerShown !== false;\n\n        return (\n          <Screen\n            key={route.key}\n            enabled\n            style={StyleSheet.absoluteFill}\n            gestureEnabled={isAndroid ? false : gestureEnabled}\n            replaceAnimation={replaceAnimation}\n            screenOrientation={screenOrientation}\n            stackAnimation={stackAnimation}\n            stackPresentation={stackPresentation}\n            statusBarAnimation={statusBarAnimation}\n            statusBarColor={statusBarColor}\n            statusBarHidden={statusBarHidden}\n            statusBarStyle={statusBarStyle}\n            statusBarTranslucent={statusBarTranslucent}\n            onWillAppear={() => {\n              navigation.emit({\n                type: 'transitionStart',\n                data: { closing: false },\n                target: route.key,\n              });\n            }}\n            onWillDisappear={() => {\n              navigation.emit({\n                type: 'transitionStart',\n                data: { closing: true },\n                target: route.key,\n              });\n            }}\n            onAppear={() => {\n              navigation.emit({\n                type: 'appear',\n                target: route.key,\n              });\n              navigation.emit({\n                type: 'transitionEnd',\n                data: { closing: false },\n                target: route.key,\n              });\n            }}\n            onDisappear={() => {\n              navigation.emit({\n                type: 'transitionEnd',\n                data: { closing: true },\n                target: route.key,\n              });\n            }}\n            onDismissed={(e) => {\n              navigation.emit({\n                type: 'dismiss',\n                target: route.key,\n              });\n\n              const dismissCount =\n                e.nativeEvent.dismissCount > 0 ? e.nativeEvent.dismissCount : 1;\n\n              navigation.dispatch({\n                ...StackActions.pop(dismissCount),\n                source: route.key,\n                target: key,\n              });\n            }}>\n            <HeaderConfig\n              {...options}\n              route={route}\n              headerShown={isHeaderInPush}\n            />\n            {maybeRenderNestedStack(\n              options,\n              route,\n              renderScene,\n              stackPresentation,\n              isHeaderInModal,\n              viewStyles\n            )}\n          </Screen>\n        );\n      })}\n    </ScreenStack>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n});\n"]}